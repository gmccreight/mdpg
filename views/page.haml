#page_ns_id

  - if mode == :normal

    :javascript
      window.pageName = "#{viewmodel.name}";

    = haml :header_partial, :locals => {:page_name => viewmodel.name}

    %h3
      %form{:action => "/p/#{viewmodel.name}/rename",
        :method => "post",
        "ng-controller" => "TokenNameCtrl",
        "ng-init" => "init('#{viewmodel.name}')"}

        %input.new_name_cls{:type => "text", :name => "new_name",
          "ng-model" => "tokenName", "ng-change" => "normalize()"}

  .rendered_markdown_cls
    ~ viewmodel.fully_rendered()

  - if mode == :normal
    = haml :pagetags_partial
    = haml :page_delete_partial, :locals => {:page => viewmodel.page}
    = haml :page_duplicate_partial, :locals => {:page => viewmodel.page}

    - PageSharingTokens::TOKEN_TYPES.each do |token_type|
      - if token_value = viewmodel.page.send(:"#{token_type}_sharing_token")
        %div
          global #{token_type} sharing:
          %form{:action => "/p/#{viewmodel.name}/rename_sharing_token",
            :method => "post"}
            %input{:type => "hidden", :name => "token_type",
              :value => token_type}
            %input.new_name_cls{:type => "text", :name => "new_token",
              :value => token_value}
